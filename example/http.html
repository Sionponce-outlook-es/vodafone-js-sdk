<!DOCTYPE html>
<html>
<head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="static/lib/jquery/dist/jquery.min.js"></script>
    <script src="static/lib/crypto-js/rollups/md5.js"></script>
    <script src="static/lib/crypto-js/rollups/rabbit.js"></script>
    <script src="static/lib/fingerprint/fingerprint.js"></script>
    <script src="static/lib/ua-parser-js/src/ua-parser.min.js"></script>
    <script src="static/lib/persist-js/persist-min.js"></script>
    <script src="static/dist/vodafone.pre.debug.js"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

    <title>Seamless ID</title>

    <style>
        .form-horizontal .control-label {
            text-align: left;
        }

        .console {
            max-height: 300px;
            overflow-y: scroll;
        }

        #console {
            font-size: 10px;
        }
    </style>
</head>


<body>

<div class="container">
    <div class="row">
        <div class="col-md-12">
            <h3>Seamless ID Javascript SDK testing page</h3>
            <hr/>
        </div>
    </div>
</div>

<div class="container">

    <div class="row">
        <div class="col-md-10">
            <form class="form-horizontal">
                <div class="form-group form-group-sm">
                    <label for="clientId" class="control-label col-xs-3">Client ID</label>

                    <div class="col-xs-9">
                        <input type="text" class="form-control" id="clientId" value="l8d0ESc5vk5vHlOosrPaAxqYANKR2KSH"/>
                    </div>
                </div>
                <div class="form-group form-group-sm">
                    <label for="clientSecret" class="control-label col-xs-3">Client Secret</label>

                    <div class="col-xs-9">
                        <input type="text" class="form-control" id="clientSecret" value="oRwUAwm9R9CT5Xx1"/>
                    </div>
                </div>
                <div class="form-group form-group-sm">
                    <label for="backendId" class="control-label col-xs-3">Backend ID</label>

                    <div class="col-xs-9">
                        <input type="text" class="form-control" id="backendId" value="WCejf6WmXCw7fK07HzWMbTtJyYuEfQwc"/>
                    </div>
                </div>
                <div class="form-group form-group-sm">
                    <label for="msisdn" class="control-label col-xs-3">MSISDN</label>

                    <div class="col-xs-9">
                        <input type="text" class="form-control" id="msisdn" value="">
                    </div>
                </div>
                <div class="form-group form-group-sm">
                    <label for="pin" class="control-label col-xs-3">PIN</label>

                    <div class="col-xs-9">
                        <input type="text" class="form-control" id="pin">
                    </div>
                </div>
            </form>
        </div>
    </div>

    <div class="row">
        <div class="col-md-10">
            <div class="btn-group">
                <button type="button" class="btn btn-default" id="resetButton">Reset values</button>
                <button type="button" class="btn btn-default" id="initButton">Invoke .init</button>
                <button type="button" class="btn btn-default" id="getTokenButton">Invoke getToken()</button>
                <button type="button" class="btn btn-default" id="confirmTokenButton">Invoke confirmToken()</button>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-10">
            <div class="panel panel-default">
                <div class="panel-body console">
                    <pre id="console"></pre>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    var console = {};
    console.log = function(message) {
        displayMessage("color: #333333", message);
    };
    console.debug = function(message) {
        displayMessage("color: #333333", message);
    };
    console.info = function(message) {
        displayMessage("color: #008000", message);
    };
    console.error = function (message) {
        displayMessage("color: #FF0000", message);
    };

    var displayMessage = function(style, message) {
        if ($("#console").length > 0) {
            $("#console").append("<span style='" +style+ "'>" + message + "</span></br>");
        }
    }

    $(function () {
        $("#initButton").click(function () {
            var initParameters = {
                clientAppKey: $("#clientId").val(),
                clientAppSecret: $("#clientSecret").val()
            };
            HE.init(initParameters, initCallback);
        });
        $("#getTokenButton").click(function () {
            var msisdn = $("#msisdn").val();
            HE.getToken(msisdn, successCallback, errorCallback);
        });
        $("#confirmTokenButton").click(function () {
            HE.confirmToken();
        });
    });

    var successCallback = function (heResult) {
        console.info("Success callback");
        console.info(JSON.stringify(heResult, undefined, 2));
    };

    var errorCallback = function (heResult) {
        console.error("Error callback");
        console.error(JSON.stringify(heResult, undefined, 2));
    };

    var initCallback = function(heResult) {
        console.info("Init callback");
        console.info(JSON.stringify(heResult, undefined, 2));
    };
    //    function handleResolvedUserData(result) {
    //        if (result.code === HE.Result.codes.TOKEN_CREATED) {
    //            $('#status').text('Received token ' + result.data.tokenId);
    //        } else if (result.code === HE.Result.codes.OTP_SMS_SENT) {
    //            $('#status').text('PIN sent to the given MSISDN');
    //            $('#confirmation').show();
    //        } else {
    //            $('#status').text('Unsupported result');
    //        }
    //    }
    //
    //    function handleError(result) {
    //        $('#status').text('Caught an error: ' + result.code + ' ' + result.message);
    //    }
    //
    //    $('#pin-confirm').click(function () {
    //        he.confirmToken($("#pin").val(), handleResolvedUserData, handleError);
    //    });
    //
    //    var he = HE.init({
    //        applicationId: 'curlscript',
    //        clientAppKey: 'I1OpZaPfBcI378Bt7PBhQySW5Setb8eb',
    //        clientAppSecret: 'k4l1RXZGqMnw2cD8',
    //        cookiesAllowed: false
    //    });
    //
    //    setTimeout(function () {
    //        HE.getToken(
    //                '491735606200',
    //                handleResolvedUserData,
    //                handleError
    //        );
    //    }, 3000);
</script>
</body>
</html>