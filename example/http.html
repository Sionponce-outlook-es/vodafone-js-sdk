<!DOCTYPE html>
<html>
<head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">

    <title>Seamless ID</title>
</head>
<body>
	<h1>Static page with he.js under http</h1>
    <h3>Status: <span id="status"></span></h3>
    <h3 id="confirmation" style="display: none;">Confirmation: <input id="pin" type="text" placeholder="PIN"><button id="pin-confirm">Confirm</button></h3>

    <script src="static/lib/jquery/dist/jquery.min.js"></script>
    <script src="static/lib/crypto-js/rollups/md5.js"></script>
    <script src="static/lib/crypto-js/rollups/rabbit.js"></script>
    <script src="static/lib/fingerprint/fingerprint.js"></script>
    <script src="static/lib/ua-parser-js/src/ua-parser.min.js"></script>
    <script src="static/lib/persist-js/persist-min.js"></script>
    <script src="static/vodafone.debug.js"></script>
    <script>
        function handleResolvedUserData(result) {
            if (result.code === HE.Result.codes.TOKEN_CREATED) {
                $('#status').text('Received token ' + result.data.tokenId);
            } else if (result.code === HE.Result.codes.OTP_SMS_SENT) {
                $('#status').text('PIN sent to the given MSISDN');
                $('#confirmation').show();
            } else {
                $('#status').text('Unsupported result');
            }
        }

        function handleError(result) {
            $('#status').text('Caught an error: ' + result.code + ' ' + result.message);
        }

        $('#pin-confirm').click(function() {
            he.confirmToken($("#pin").val(), handleResolvedUserData, handleError);
        });

        var he = HE.init({
            applicationId: 'curlscript',
            clientAppKey: 'I1OpZaPfBcI378Bt7PBhQySW5Setb8eb',
            clientAppSecret: 'k4l1RXZGqMnw2cD8',
            cookiesAllowed: false
        });

        setTimeout(function() {
            he.getToken(
                '491741863437',
                handleResolvedUserData,
                handleError
            );
        }, 3000);
    </script>
</body>
</html>